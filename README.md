# 라이어 게임 (Flask + Socket.IO)

모바일 브라우저로 링크에 접속해 함께 즐기는 라이어 게임입니다. UI는 파스텔 톤의 귀여운 느낌으로 구성했습니다.  
`Render`에 바로 배포할 수 있도록 `render.yaml`을 포함했습니다.

## 주요 기능
- 메인 → 로비 → 게임 전개
- **호스트(개발자 코드)** 만 "게임 시작" 가능 (`ADMIN_CODE` 환경변수)
- 플레이어 수에 따른 역할 자동 배정  
  - 7인 이상: 라이어 1명, 스파이 1명, 나머지 시민  
  - 6인 이하: 라이어 1명, 나머지 시민
- 라이어: **주제만 제공**, 시민/스파이: **주제+제시어 제공**
- 진행 단계 자동화
  1) 개별 힌트 15초씩 → 2) 전체 토론 2분 → 3) 1차 투표 → (동률 시) 동률자 발언 20초 → 재투표 → (지목 결과) 라이어 정답 기회 30초  
- 승리 조건 & 점수 반영
  - 시민 승: 라이어가 지목되고 정답 **실패** → 시민 전원 +1점
  - 라이어/스파이 승1: 라이어 **지목 실패** → 라이어 +2, 스파이 +1
  - 라이어/스파이 승2: 라이어 **지목 성공** & 정답 **맞춤** → 라이어 +2, 스파이 +1
- 총 **5라운드** 진행 후 최종 점수표 제공(클라이언트에서 CSV 다운로드)

## 폴더 구조
```
.
├─ app.py              # 서버 (Flask + Socket.IO, eventlet)
├─ requirements.txt
├─ render.yaml         # Render 배포 설정
├─ Procfile            # (선택) Gunicorn 실행 스펙
├─ data/
│   └─ topics.json     # ★ 주제/제시어 데이터 (app.py 바깥 별도 파일)
├─ templates/
│   └─ index.html      # 단일 페이지 앱 (메인/로비/게임)
└─ static/
    ├─ style.css
    ├─ client.js
    └─ fonts/          # (옵션) 사용자 보유 폰트를 여기에 넣어 사용
```

## 로컬 실행
```bash
python -m venv .venv
source .venv/bin/activate  # (Windows: .venv\Scripts\activate)
pip install -r requirements.txt
export ADMIN_CODE=BOM  # 개발자 코드 (원하면 변경)
python app.py
# http://localhost:8000 접속
```

## Render 배포
1. 이 폴더를 깃 저장소에 올립니다.
2. Render 대시보드에서 **New → Web Service** 선택 후 저장소를 연결합니다.
3. 자동으로 `render.yaml`을 감지합니다.
4. 배포 후, 대시보드 **Environment**에서 `ADMIN_CODE`를 원하는 값으로 변경하세요.
5. 배포 URL을 플레이어와 공유하면 각자 휴대폰 브라우저로 접속해 게임할 수 있습니다.

## 사용법
- 메인에서 이름을 입력 → "게임 로비 입장"
- 개발자는 **호스트 코드** 입력 후 "게임 시작"
- 각 라운드가 자동 진행됩니다. (타이머와 단계가 화면 상단에 표시)
- 투표는 이름 버튼을 눌러 제출합니다.
- 라이어가 지목되면 **정답 입력칸**이 라이어에게만 나타납니다.

## 동작 규칙 상세
- **재투표 후에도 동률**이 발생하면, "최다 득표자 부재"로 처리되어 라이어/스파이 승리로 판정합니다.
- 투표 시간 내 아무도 투표하지 않으면 라이어/스파이 승리로 처리합니다.
- 라운드마다 **역할은 새로 배정**됩니다.
- 라이어 정답 판정은 **문자 그대로 일치** 기준입니다(공백/개행은 무시). 필요 시 동의어 처리 로직을 추가할 수 있습니다.

## 커스텀 팁
- 타이머(힌트/토론/발언/정답/투표) 시간은 환경변수로 조정 가능합니다.
  - `HINT_SECONDS`, `DISCUSS_SECONDS`, `TIE_SPEECH_SECONDS`, `LIAR_GUESS_SECONDS`, `VOTE_SECONDS`
- 귀여운 폰트 사용을 원하면 `static/fonts/`에 폰트 파일을 넣고 `style.css`에 `@font-face`를 추가하세요.
- 여러 방(룸) 지원도 확장 가능합니다. (현재는 하나의 로비/게임 인스턴스 기준)

즐거운 라이어 게임 되세요! :)
